package org.db.psd.impl;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import org.db.psd.base.Execute_CRUD;
import org.db.psd.dao.ShopDAO;
import org.db.psd.model.Shop;

public class ShopDAOImplement extends Execute_CRUD implements ShopDAO {

	@Override
	public boolean shopCreate(Shop shop) {
		String sql = "insert into shop (shopName,shopAddress,shopPhone) value (?,?,?)";
		String shopName = shop.getShopName();
		String shopAddress = shop.getShopAddress();
		String shopPhone = shop.getShopPhone();
		Object[] object = { shopName, shopAddress, shopPhone };
		boolean b = execute_CUD(sql, object);
		return b;
	}

	@Override
	public Shop shopById(int shopId) {
		String sql = "select * from shop where shopId = ?";
		Object[] object = { shopId };
		Shop shop = null;
		ResultSet rs = execute_Query(sql, object);
		try {
			if (rs.next()) {
				String shopName = rs.getString("shopName");
				String shopAddress = rs.getString("shopAddress");
				String shopPhone = rs.getString("shopPhone");
				shop = new Shop(shopId, shopName, shopAddress, shopPhone);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			closeRs(rs);
		}
		return shop;
	}

	@Override
	public boolean shopUpdate(Shop shop) {
		
		String sql = "update shop set shopName = ?,shopAddress = ?,shopPhone = ? where shopId = ?";
		
		int shopId = shop.getShopId();
		String shopName = shop.getShopName();
		String shopAddress = shop.getShopAddress();
		String shopPhone = shop.getShopPhone();
		Object[] object = { shopName, shopAddress, shopPhone, shopId };
		
		boolean b = execute_CUD(sql, object);
		
		return b;
	}

	@Override
	public List<Shop> shopList() {
		String sql="select * from shop ";
		List<Shop> shops=new ArrayList<Shop>();
		Shop shop=null;
		ResultSet rs=execute_Query(sql, null);
		try {
			while(rs.next()) {
				int shopId=rs.getInt("shopId") ;
			    String shopName =rs.getString("shopName");
			    String shopAddress =rs.getString("shopAddress");
			    String shopPhone=rs.getString("shopPhone");
			    shop=new Shop(shopId, shopName, shopAddress, shopPhone);
			    shops.add(shop);
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}finally {
			closeRs(rs);
		}
		return shops;
	}

}
