package org.db.psd.impl;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import org.db.psd.base.Execute_CRUD;
import org.db.psd.dao.ShopStoreDAO;
import org.db.psd.model.Shopstore;

public class ShopStoreDAOImplement extends Execute_CRUD implements ShopStoreDAO {

	@Override
	public boolean shopStoreCreate(Shopstore shopstore) {
		String sql  = "insert into shopstore (shopStoreNum,shopStoreTime,shopId,produceId,outboundId , employeeId) value (?,now(),?,?,?,?)";
		
		int shopStoreNum = shopstore.getShopStoreNum();
		int shopId = shopstore.getShopStoreId();
		int produceId = shopstore.getProduceId();
		int outboundId = shopstore.getOutboundId();
		int employeeId = shopstore.getEmployeeId();
		Object [] objects = {shopStoreNum,shopId,produceId,outboundId,employeeId};
		
		boolean b = execute_CUD(sql, objects);
		
		return b;
	}

	@Override
	public List<Shopstore> shopStoreByShopId(int shopId) {
		String sql = "select * frm Shopstore where shopId = ?";
		
		Object [] objects = {shopId};
		
		ResultSet rs = execute_Query(sql, objects);
		
		List<Shopstore> shopStores = new ArrayList<Shopstore>();
		
		Shopstore shopStore = null;
		
		try {
			while(rs.next()) {
				int shopStoreId = rs.getInt("shopStoreId");
				int shopStoreNum = rs.getInt("shopStoreNum");
				Date shopStoreTime = rs.getDate("shopStoreTime");
				int produceId = rs.getInt("produceId");
				int outboundId = rs.getInt("outboundId");
				int employeeId = rs.getInt("employeeId");
				shopStore = new Shopstore(shopStoreId, shopStoreNum, shopStoreTime, shopId, produceId, outboundId, employeeId);
				shopStores.add(shopStore);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}finally {
			closeRs(rs);
		}
		return shopStores;
	}

	@Override
	public List<Shopstore> shopStoreByProduceId(int produceId) {
		
		String sql ="select * from shopstore where produceId = ?";
		
		Object [] objects = {produceId};
		
		ResultSet rs = execute_Query(sql, objects);
		
		List<Shopstore> shopStores = new ArrayList<Shopstore>();
		Shopstore shopStore = null;
		
		try {
			while(rs.next()) {
				int shopId = rs.getInt("shopId");
				int shopStoreId = rs.getInt("shopStoreId");
				int shopStoreNum = rs.getInt("shopStoreNum");
				Date shopStoreTime = rs.getDate("shopStoreTime");
				int outboundId = rs.getInt("outboundId");
				int employeeId = rs.getInt("employeeId");
				shopStore = new Shopstore(shopStoreId, shopStoreNum, shopStoreTime, shopId, produceId, outboundId, employeeId);
				shopStores.add(shopStore);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}finally {
			closeRs(rs);
		}
		return shopStores;
	}

}
